{"description":"Get Single Response","component":"com.sap.system.python3Operator","inports":[{"name":"responseID","type":"string"}],"outports":[{"name":"response","type":"string"}],"iconsrc":"qualtrics-xm-long.svg","config":{"$type":"http://sap.com/vflow/com.poc.qualtrics.getResponse.configSchema.json","script":"import requests\nimport json\nfrom io import StringIO\nimport csv\n\ndef jsonToCsv(data):\n    output = StringIO()\n    writer = csv.DictWriter(output, data[0].keys())\n    writer.writeheader()\n    \n    for row in data:\n        writer.writerow(row)\n    \n    return output\n\napiToken = api.config.apiToken\nsurveyID = api.config.surveyID\ndataCenter = api.config.dataCenter\n\ndef on_input(sResponseID):\n    oResponseID = json.loads(sResponseID)\n    responseID = oResponseID[\"responseID\"]\n    baseUrl = \"https://{0}.qualtrics.com/API/v3/surveys/{1}/responses/{2}\".format(dataCenter, surveyID, responseID)\n    headers = {\n        \"accept\": \"application/json\",\n        \"x-api-token\": apiToken\n        }\n\n    requestUrl = baseUrl\n    downloadRequestResponse = requests.request(\"GET\", requestUrl, headers=headers)\n    print(downloadRequestResponse.text)\n    responseValues = downloadRequestResponse.json()[\"result\"][\"values\"]\n    csvValues = jsonToCsv([responseValues]).getvalue()\n\n    api.send(\"response\", csvValues)\n\napi.set_port_callback(\"responseID\", on_input)"},"tags":{"qualtrics":""}}