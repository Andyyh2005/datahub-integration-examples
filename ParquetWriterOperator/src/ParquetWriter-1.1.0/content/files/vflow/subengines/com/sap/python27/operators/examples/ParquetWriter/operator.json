{"description":"ParquetWriter","component":"com.sap.system.python2Operator","inports":[{"name":"input","type":"message"}],"outports":[{"name":"output","type":"message"}],"icon":"puzzle-piece","iconsrc":"parquet_logo.png","config":{"script":"import json\nimport pandas as pd\nimport pyarrow as pa\nimport pyarrow.parquet as pq\n\ndef on_input(data):\n    \n    #create pandas data frame from Data section (=query result from HANA Client)\n    body = data.body\n    df = pd.read_json(json.dumps(body))\n    \n    # use pyarrow to write dataframe into buffer\n    pt = pa.Table.from_pandas(df)\n    output = pa.BufferOutputStream()\n    pq.write_table(pt, output)\n    buf = output.getvalue()\n\n    # send output to next operator\n    api.send(\"output\", api.Message(str(buf.to_pybytes()), None))\n\napi.set_port_callback(\"input\", on_input)"},"tags":{"pandas":"","pyarrow":"","python27":""}}